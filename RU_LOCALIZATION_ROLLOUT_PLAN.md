# План внедрения русской локализации (обновленный)

## 1. Цели
- Добавить полноценную поддержку `ru` вместе с `en`.
- Русская версия должна открываться по URL с префиксом `/ru`.
- На главной странице добавить переключатель языка.
- Обеспечить перевод пользовательского контента интерфейса через `next-intl`.

## 2. Архитектурные решения
- Использовать locale prefix routing через middleware (`/en`, `/ru`).
- Не переводить slug маршрутов на этом этапе; только префикс локали.
- Источник переводов: `messages/en.json` и `messages/ru.json`.
- При отсутствии ключа в `ru` использовать fallback на `en` в runtime-конфиге.

## 3. Middleware и маршрутизация
- Подключить locale-aware middleware с поддержкой `en/ru` и префиксом.
- Нормализовать protected-route проверки с учетом locale сегмента.
- Редиректы auth-flow делать на локализованные URL (`/{locale}/login`, `/{locale}/dashboard`).
- Исключить `api/_next/static/_next/image/assets` из locale-обработки.

## 4. i18n request config
- Перейти с фиксированного `en` на динамический выбор locale.
- Валидировать locale по белому списку.
- Загружать messages по выбранной локали.

## 5. Переводы
- Создать `messages/ru.json` полной структуры (зеркало `en.json`).
- Перевести существующие namespace: common, auth, dashboard, projects, subscription, documents, errors, validation, legal, platforms, postTone, generatePage.
- Добавить namespace для главной страницы (`landing`) и футера (`footer`) при необходимости.

## 6. Главная страница и язык-переключатель
- Перевести весь текст главной страницы на ключи `next-intl`.
- Добавить language switcher в header (минимум на главной; допускается глобально).
- Переключатель должен сохранять текущий path/query и менять только locale сегмент URL.

## 7. Технические доработки UI
- Убрать хардкод-строки в общих layout-компонентах (header/footer/sidebar), перенести в messages.
- Проверить aria-label и служебные тексты.
- Обновить html lang в layout по текущей локали.

## 8. SEO и стабильность
- Подготовить основу под `hreflang`/canonical (если не блокирует релиз — отдельным шагом).
- Определить единый redirect policy для URL без locale.

## 9. Проверки
- Unit/smoke: корректное определение locale в middleware.
- Ручная проверка основных маршрутов в `en` и `ru`.
- Проверка auth redirect в обоих locales.
- Проверка переключателя языка.
- `npm test` и `npm run build` обязательны.

## 10. Критерии приемки
- `/ru` и вложенные `/ru/...` работают корректно.
- Главная полностью переключается на русский.
- Основные пользовательские страницы читают тексты из `messages`.
- Навигация и auth-редиректы сохраняют локаль.
- Сборка и тесты проходят.
